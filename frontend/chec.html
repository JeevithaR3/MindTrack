<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Safety Tutor - Learn with Foxy!</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/canvas-confetti/1.6.0/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="checklandingpriya.css">
</head>
<body>
    <!-- Floating Particles -->
    <div class="particles" id="particles"></div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1 class="title">🛡️ Cyber Safety Academy</h1>
            <div class="stats-container">
                <div class="stat-box">
                    🔥 Streak: <span id="streakCount">5</span> days
                </div>
                <div class="stat-box">
                    ⚡ XP: <span id="xpCount">150</span>
                </div>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 30%"></div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Welcome Message -->
        <section class="welcome-message">
            <h2 class="welcome-title">Welcome to Cyber Safety Adventure! 🌟</h2>
            <p class="welcome-subtitle">Enter quests to learn about online safety and become a Cyber Hero with Foxy!</p>
        </section>

        <!-- Foxy Character -->
        <div class="foxy-container" id="foxyContainer">
            <div class="foxy" id="foxy">
                <div class="foxy-body"></div>
                <div class="foxy-head">
                    <div class="foxy-ear left"></div>
                    <div class="foxy-ear right"></div>
                    <div class="foxy-eye left">
                        <div class="foxy-pupil" id="leftPupil"></div>
                    </div>
                    <div class="foxy-eye right">
                        <div class="foxy-pupil" id="rightPupil"></div>
                    </div>
                    <div class="foxy-snout">
                        <div class="foxy-nose"></div>
                    </div>
                </div>
                <div class="foxy-tail"></div>
                <div class="voice-indicator" id="voiceIndicator" style="display: none;"></div>
            </div>
        </div>

        <!-- Quests Section -->
        <section class="quests-container">
            <h2 class="section-title">🚀 Choose Your Adventure</h2>
            <div class="quests-grid" id="questsGrid">
                <!-- Quest cards will be generated by JavaScript -->
            </div>
        </section>

        <!-- Badges Section -->
        <section class="badges-container">
            <h2 class="section-title">🏆 Your Achievements</h2>
            <div class="badges-grid" id="badgesGrid">
                <!-- Badges will be generated by JavaScript -->
            </div>
        </section>
    </main>

    <!-- Chat Toggle Button -->
    <button class="chat-toggle" id="chatToggle" onclick="toggleChat()">💬</button>

    <!-- Chatbox -->
    <div class="chatbox" id="chatbox">
        <div class="chatbox-header" onclick="toggleChat()">
            <span class="chatbox-title">💬 Ask Foxy Anything!</span>
            <span>×</span>
        </div>
        <div class="chatbox-messages" id="chatMessages">
            <div class="message bot">
                Hi there! I'm Foxy, your cyber safety guide! 🦊 Ask me anything about staying safe online!
            </div>
        </div>
        <div class="chatbox-input">
            <input type="text" id="chatInput" placeholder="Type your question..." onkeypress="handleChatEnter(event)">
            <button onclick="sendMessage()">➤</button>
        </div>
    </div>

    <!-- Quiz Modal -->
    <div class="quiz-modal" id="quizModal">
        <div class="quiz-content" id="quizContent">
            <!-- Quiz content will be generated by JavaScript -->
        </div>
    </div>

    <!-- Completion Modal -->
    <div class="completion-modal" id="completionModal">
        <div class="completion-content">
            <h2 class="completion-title">🎉 Quest Complete!</h2>
            <div class="completion-badge">🏆</div>
            <p id="completionMessage"></p>
            <button class="quest-button" onclick="closeCompletionModal()">Continue Adventure!</button>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            xp: 150,
            streak: 5,
            badges: ['Safe Surfer'],
            completedQuests: [],
            currentQuest: null,
            currentLevel: 0,
            chatOpen: false
        };

        // Quest Data
        const quests = [
            {
                id: 'password',
                title: '🔐 Password Potion',
                icon: '🔐',
                description: 'Learn to create magical strong passwords!',
                badge: 'Password Wizard 🧙‍♂️',
                levels: [
                    {
                        question: 'Which password is stronger?',
                        options: ['123456', 'MyDog2024!', 'password', 'abcdef'],
                        correct: 1,
                        explanation: 'Strong passwords have numbers, letters, and special characters!'
                    },
                    {
                        question: 'Should you share your password with friends?',
                        options: ['Yes, always', 'Only with best friends', 'Never!', 'Sometimes'],
                        correct: 2,
                        explanation: 'Passwords are like your secret diary - keep them to yourself!'
                    },
                    {
                        question: 'Where should you store passwords?',
                        options: ['On a sticky note', 'In a password manager', 'Tell your mom', 'Remember in your head'],
                        correct: 1,
                        explanation: 'Password managers are like magical vaults that keep your passwords safe!'
                    }
                ]
            },
            {
                id: 'strangers',
                title: '🚫 Stranger Danger Spell',
                icon: '🚫',
                description: 'Cast spells to stay safe from online strangers!',
                badge: 'Guardian Angel 👼',
                levels: [
                    {
                        question: 'Someone online asks for your home address. What do you do?',
                        options: ['Give it to them', 'Ask your parents first', 'Never share it', 'Only if they seem nice'],
                        correct: 2,
                        explanation: 'Never share personal information with people you meet online!'
                    },
                    {
                        question: 'A stranger wants to meet you in person. What should you do?',
                        options: ['Meet them alone', 'Tell your parents immediately', 'Ignore them', 'Meet in a public place'],
                        correct: 1,
                        explanation: 'Always tell a trusted adult if someone wants to meet you!'
                    },
                    {
                        question: 'What information is safe to share online?',
                        options: ['Your full name', 'Your school name', 'Your favorite color', 'Your phone number'],
                        correct: 2,
                        explanation: 'Only share general interests, never personal details!'
                    }
                ]
            },
            {
                id: 'links',
                title: '🧹 Clean Up Fake Links',
                icon: '🧹',
                description: 'Sweep away dangerous links and downloads!',
                badge: 'Link Detective 🕵️',
                levels: [
                    {
                        question: 'How can you tell if a link might be dangerous?',
                        options: ['It has weird spelling', 'It promises free money', 'The URL looks suspicious', 'All of the above'],
                        correct: 3,
                        explanation: 'Always be suspicious of links that seem too good to be true!'
                    },
                    {
                        question: 'What should you do before clicking any link?',
                        options: ['Click immediately', 'Check with an adult', 'Close your eyes', 'Hope for the best'],
                        correct: 1,
                        explanation: 'Always ask a trusted adult before clicking links from strangers!'
                    },
                    {
                        question: 'Where is it safest to download games?',
                        options: ['Random websites', 'Email attachments', 'Official app stores', 'Pop-up ads'],
                        correct: 2,
                        explanation: 'Official app stores check apps for safety before allowing downloads!'
                    }
                ]
            },
            {
                id: 'privacy',
                title: '🔒 Privacy Shield',
                icon: '🔒',
                description: 'Protect your personal information like a superhero!',
                badge: 'Privacy Protector 🛡️',
                levels: [
                    {
                        question: 'What should your social media profile be set to?',
                        options: ['Public for everyone', 'Private/Friends only', 'Visible to strangers', 'Open to all'],
                        correct: 1,
                        explanation: 'Keep your profiles private so only friends and family can see them!'
                    },
                    {
                        question: 'Is it okay to post photos of your house?',
                        options: ['Yes, always', 'No, never', 'Only the front', 'Only with friends'],
                        correct: 1,
                        explanation: 'Photos of your house can help strangers find where you live!'
                    },
                    {
                        question: 'What information should you never share online?',
                        options: ['Your favorite movie', 'Your address', 'Your favorite color', 'Your pet\'s name'],
                        correct: 1,
                        explanation: 'Never share your address, phone number, or school online!'
                    }
                ]
            },
            {
                id: 'cyberbullying',
                title: '💪 Anti-Bully Power',
                icon: '💪',
                description: 'Stand up against cyberbullies with kindness!',
                badge: 'Kindness Champion 🌟',
                levels: [
                    {
                        question: 'What should you do if someone is mean to you online?',
                        options: ['Be mean back', 'Tell a trusted adult', 'Ignore and block', 'Both B and C'],
                        correct: 3,
                        explanation: 'Always tell an adult and block mean people online!'
                    },
                    {
                        question: 'If you see someone being bullied online, what should you do?',
                        options: ['Join in', 'Ignore it', 'Report it and tell an adult', 'Laugh at it'],
                        correct: 2,
                        explanation: 'Be a hero by reporting bullying and getting help for others!'
                    },
                    {
                        question: 'How should you treat others online?',
                        options: ['However I want', 'With kindness and respect', 'Mean if they\'re mean first', 'Ignore everyone'],
                        correct: 1,
                        explanation: 'Treat others online the same way you\'d want to be treated!'
                    }
                ]
            },
            {
                id: 'downloads',
                title: '⬇️ Download Defense',
                icon: '⬇️',
                description: 'Defend against dangerous downloads!',
                badge: 'Download Guardian 🛡️',
                levels: [
                    {
                        question: 'When is it safe to download something?',
                        options: ['Always', 'Never', 'With parent permission', 'From any website'],
                        correct: 2,
                        explanation: 'Always ask a parent or guardian before downloading anything!'
                    },
                    {
                        question: 'What might happen if you download from unsafe sites?',
                        options: ['Nothing', 'Viruses on your computer', 'Better games', 'Faster internet'],
                        correct: 1,
                        explanation: 'Unsafe downloads can put viruses on your computer!'
                    },
                    {
                        question: 'Which file types can be dangerous?',
                        options: ['.txt files', '.exe files', '.jpg photos', '.mp3 music'],
                        correct: 1,
                        explanation: '.exe files can contain viruses that harm your computer!'
                    }
                ]
            },
            {
                id: 'gaming',
                title: '🎮 Safe Gaming Quest',
                icon: '🎮',
                description: 'Game safely and make real friends online!',
                badge: 'Gaming Guardian 🎯',
                levels: [
                    {
                        question: 'What should you do if someone asks for personal info in a game?',
                        options: ['Share everything', 'Give them fake info', 'Don\'t share anything personal', 'Only share your age'],
                        correct: 2,
                        explanation: 'Never share personal information with people in games!'
                    },
                    {
                        question: 'How should you choose a gaming username?',
                        options: ['Use your real name', 'Use your address', 'Use something fun but not personal', 'Use your phone number'],
                        correct: 2,
                        explanation: 'Choose fun usernames that don\'t reveal who you really are!'
                    },
                    {
                        question: 'What should you do if someone is being mean in a game?',
                        options: ['Be mean back', 'Report and block them', 'Give them your personal info', 'Keep playing with them'],
                        correct: 1,
                        explanation: 'Report mean players and block them to keep gaming fun!'
                    }
                ]
            },
            {
                id: 'social',
                title: '📱 Social Media Smarts',
                icon: '📱',
                description: 'Be smart and safe on social media!',
                badge: 'Social Star ⭐',
                levels: [
                    {
                        question: 'How often should you check your privacy settings?',
                        options: ['Never', 'Once a year', 'Regularly', 'Only when problems happen'],
                        correct: 2,
                        explanation: 'Check your privacy settings regularly to stay safe!'
                    },
                    {
                        question: 'Should you accept friend requests from people you don\'t know?',
                        options: ['Yes, always', 'No, never', 'Only if they look nice', 'Only if they have mutual friends'],
                        correct: 1,
                        explanation: 'Only accept friends from people you know in real life!'
                    },
                    {
                        question: 'What should you think about before posting anything?',
                        options: ['Nothing', 'Would I want my grandma to see this?', 'Will this get lots of likes?', 'Is this funny?'],
                        correct: 1,
                        explanation: 'Always think: would I be okay if anyone could see this forever?'
                    }
                ]
            },
            {
                id: 'email',
                title: '📧 Email Safety Expert',
                icon: '📧',
                description: 'Master the art of safe email practices!',
                badge: 'Email Expert 💌',
                levels: [
                    {
                        question: 'What should you do with emails from people you don\'t know?',
                        options: ['Open all attachments', 'Delete without opening', 'Forward to friends', 'Reply immediately'],
                        correct: 1,
                        explanation: 'Delete emails from strangers - they might contain viruses or tricks!'
                    },
                    {
                        question: 'How can you tell if an email might be fake?',
                        options: ['Poor spelling and grammar', 'Asks for personal information', 'Seems too good to be true', 'All of the above'],
                        correct: 3,
                        explanation: 'Fake emails often have bad spelling and ask for personal information!'
                    },
                    {
                        question: 'Should you click links in emails from strangers?',
                        options: ['Always', 'Never', 'Only if they look safe', 'Only if they promise prizes'],
                        correct: 1,
                        explanation: 'Never click links from strangers - they might take you to dangerous websites!'
                    }
                ]
            }
        ];

        // Initialize the game
        function initGame() {
            createParticles();
            generateQuestCards();
            updateStats();
            updateBadges();
            startEyeTracking();
            addFoxyGreeting();
        }

        // Create floating particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.width = Math.random() * 8 + 4 + 'px';
                particle.style.height = particle.style.width;
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Generate quest cards
        function generateQuestCards() {
            const questsGrid = document.getElementById('questsGrid');
            questsGrid.innerHTML = '';

            quests.forEach(quest => {
                const questCard = document.createElement('div');
                questCard.className = `quest-card ${gameState.completedQuests.includes(quest.id) ? 'completed' : ''}`;
                questCard.innerHTML = `
                    <div class="quest-icon">${quest.icon}</div>
                    <h3 class="quest-title">${quest.title}</h3>
                    <p class="quest-description">${quest.description}</p>
                    <button class="quest-button" onclick="startQuest('${quest.id}')" 
                            ${gameState.completedQuests.includes(quest.id) ? 'disabled' : ''}>
                        ${gameState.completedQuests.includes(quest.id) ? 'Completed! ✅' : 'Start Quest ⚡'}
                    </button>
                `;
                questsGrid.appendChild(questCard);
            });
        }

        // Start a quest
        function startQuest(questId) {
            const quest = quests.find(q => q.id === questId);
            if (!quest) return;

            gameState.currentQuest = quest;
            gameState.currentLevel = 0;
            showNextQuestion();
        }

        // Show next question
        function showNextQuestion() {
            const quest = gameState.currentQuest;
            const level = quest.levels[gameState.currentLevel];

            if (!level) {
                completeQuest();
                return;
            }

            const modal = document.getElementById('quizModal');
            const content = document.getElementById('quizContent');

            content.innerHTML = `
                <h2 class="quiz-question">${level.question}</h2>
                <div class="quiz-options">
                    ${level.options.map((option, index) => `
                        <div class="quiz-option" onclick="selectAnswer(${index})">
                            ${option}
                        </div>
                    `).join('')}
                </div>
                <div class="explanation" style="display: none;" id="explanation">
                    ${level.explanation}
                </div>
                <button class="quest-button" style="display: none;" id="nextButton" onclick="nextLevel()">
                    Next Level ➡️
                </button>
            `;

            modal.classList.add('active');
        }

        // Select an answer
        function selectAnswer(selectedIndex) {
            const quest = gameState.currentQuest;
            const level = quest.levels[gameState.currentLevel];
            const options = document.querySelectorAll('.quiz-option');
            const explanation = document.getElementById('explanation');
            const nextButton = document.getElementById('nextButton');

            options.forEach((option, index) => {
                option.style.pointerEvents = 'none';
                if (index === level.correct) {
                    option.classList.add('correct');
                } else if (index === selectedIndex && index !== level.correct) {
                    option.classList.add('incorrect');
                }
            });

            if (selectedIndex === level.correct) {
                // Correct answer
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                speakText("Great job! That's correct! 🌟");
                gameState.xp += 50;
            } else {
                // Incorrect answer
                speakText("Oops! Let's try to learn from this! 🤔");
            }

            explanation.style.display = 'block';
            nextButton.style.display = 'block';
            updateStats();
        }

        // Move to next level
        function nextLevel() {
            gameState.currentLevel++;
            showNextQuestion();
        }

        // Complete a quest
        function completeQuest() {
            const quest = gameState.currentQuest;
            gameState.completedQuests.push(quest.id);
            gameState.badges.push(quest.badge);
            gameState.xp += 100;

            document.getElementById('quizModal').classList.remove('active');

            // Show completion modal
            const completionModal = document.getElementById('completionModal');
            const completionMessage = document.getElementById('completionMessage');

            completionMessage.innerHTML = `
                <p style="font-size: 1.3rem; color: #00695c; margin-bottom: 1rem;">
                    🎉 Congratulations! You've earned the <strong>${quest.badge}</strong> badge!
                </p>
                <button class="quest-button" onclick="showLearnMore('${quest.id}')" style="margin: 0.5rem;">
                    Learn More About ${quest.title.replace(/[🔐🚫🧹🔒💪⬇️🎮📱📧]/g, '').trim()} 📚
                </button>
            `;

            completionModal.classList.add('active');

            // Massive confetti celebration
            setTimeout(() => {
                confetti({
                    particleCount: 200,
                    spread: 100,
                    origin: { y: 0.4 }
                });
            }, 300);

            speakText(`Fantastic! You've completed the ${quest.title} quest and earned the ${quest.badge} badge!`);

            updateStats();
            updateBadges();
            generateQuestCards();

            // Check if all quests are completed
            if (gameState.completedQuests.length === quests.length) {
                setTimeout(() => {
                    showCyberMasterCertificate();
                }, 2000);
            }
        }

        // Show learn more content
        function showLearnMore(questId) {
            const learnMoreContent = {
                'password': 'Remember: Strong passwords are like secret spells! Use a mix of uppercase letters, lowercase letters, numbers, and special characters. Never use personal information like your birthday or pet\'s name. And most importantly, keep your passwords secret!',
                'strangers': 'Stay safe online by never sharing personal information with strangers. If someone makes you uncomfortable or asks to meet in person, always tell a trusted adult immediately. Remember: real friends don\'t pressure you to share personal details!',
                'links': 'Be a link detective! Look for weird spelling, suspicious URLs, or promises that seem too good to be true. When in doubt, ask an adult before clicking. Stick to official websites and app stores for downloads!',
                'privacy': 'Your privacy is your superpower! Keep your profiles private, think before you post, and remember that anything you share online can be there forever. Protect your personal information like a treasure!',
                'cyberbullying': 'Spread kindness online! If someone is mean to you, don\'t respond with meanness. Block them, report them, and tell a trusted adult. Be a hero by standing up for others who are being bullied too!',
                'downloads': 'Only download from trusted sources with adult permission. Avoid pop-up ads and emails with attachments from strangers. Stick to official app stores and websites you know are safe!',
                'gaming': 'Game safely by choosing usernames that don\'t reveal personal information. Report and block players who are mean or ask for personal details. Remember: online gaming friends should stay online friends!',
                'social': 'Be social media smart! Keep your profiles private, only accept friend requests from people you know in real life, and think carefully before posting anything. Would you be okay if everyone could see it?',
                'email': 'Be an email expert! Delete emails from strangers, never click suspicious links, and be wary of emails asking for personal information or promising free prizes. When in doubt, ask an adult!'
            };

            alert(learnMoreContent[questId] || 'Keep learning and staying safe online!');
        }

        // Show Cyber Master Certificate
        function showCyberMasterCertificate() {
            const completionModal = document.getElementById('completionModal');
            const completionContent = document.querySelector('.completion-content');

            completionContent.innerHTML = `
                <h2 class="completion-title">🏆 CYBER MASTER ACHIEVED! 🏆</h2>
                <div class="completion-badge">👑</div>
                <p style="font-size: 1.5rem; color: #00695c; margin: 1rem 0;">
                    🎊 INCREDIBLE! You've completed ALL cyber safety quests! 🎊
                </p>
                <p style="font-size: 1.2rem; color: #00838f; margin: 1rem 0;">
                    You are now officially a <strong>CYBER MASTER</strong>! 
                    You have the knowledge and skills to stay safe online and help others too!
                </p>
                <div style="background: linear-gradient(135deg, #ffd54f, #ffeb3b); padding: 1.5rem; border-radius: 15px; margin: 1rem 0; border: 3px solid #f57f17;">
                    <h3 style="color: #f57f17; margin-bottom: 0.5rem;">🏆 CYBER MASTER CERTIFICATE 🏆</h3>
                    <p style="color: #f57f17; font-weight: bold;">This certifies that you have mastered all aspects of cyber safety!</p>
                </div>
                <button class="quest-button" onclick="closeCompletionModal()" style="margin-top: 1rem;">
                    Celebrate! 🎉
                </button>
            `;

            completionModal.classList.add('active');

            // Epic confetti celebration
            let confettiCount = 0;
            const confettiInterval = setInterval(() => {
                confetti({
                    particleCount: 150,
                    spread: 120,
                    origin: { x: Math.random(), y: 0.6 }
                });
                confettiCount++;
                if (confettiCount >= 5) {
                    clearInterval(confettiInterval);
                }
            }, 300);

            speakText("AMAZING! You are now a Cyber Master! You've learned everything you need to stay safe online!");

            // Add Cyber Master badge
            gameState.badges.push('Cyber Master 👑');
            updateBadges();
        }

        // Close completion modal
        function closeCompletionModal() {
            document.getElementById('completionModal').classList.remove('active');
        }

        // Update stats display
        function updateStats() {
            document.getElementById('streakCount').textContent = gameState.streak;
            document.getElementById('xpCount').textContent = gameState.xp;
            
            const progressPercentage = Math.min((gameState.xp / 1000) * 100, 100);
            document.getElementById('progressFill').style.width = progressPercentage + '%';
        }

        // Update badges display
        function updateBadges() {
            const badgesGrid = document.getElementById('badgesGrid');
            badgesGrid.innerHTML = '';

            gameState.badges.forEach(badge => {
                const badgeElement = document.createElement('div');
                badgeElement.className = 'badge';
                badgeElement.textContent = badge;
                badgesGrid.appendChild(badgeElement);
            });
        }

        // Eye tracking for Foxy
        function startEyeTracking() {
            document.addEventListener('mousemove', (e) => {
                const foxy = document.getElementById('foxy');
                const foxyRect = foxy.getBoundingClientRect();
                const foxyCenterX = foxyRect.left + foxyRect.width / 2;
                const foxyCenterY = foxyRect.top + foxyRect.height / 2;

                const angle = Math.atan2(e.clientY - foxyCenterY, e.clientX - foxyCenterX);
                const distance = Math.min(Math.sqrt(Math.pow(e.clientX - foxyCenterX, 2) + Math.pow(e.clientY - foxyCenterY, 2)) / 200, 1);

                const leftPupil = document.getElementById('leftPupil');
                const rightPupil = document.getElementById('rightPupil');

                const offsetX = Math.cos(angle) * distance * 3;
                const offsetY = Math.sin(angle) * distance * 3;

                leftPupil.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
                rightPupil.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
            });
        }

        // Add Foxy greeting
        function addFoxyGreeting() {
            document.getElementById('foxy').addEventListener('click', () => {
                speakText("Hi there! I'm Foxy, your cyber safety guide! Click on the quests to start learning!");
            });
        }

        // Text-to-speech function
        function speakText(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.9;
                utterance.pitch = 1.2;
                utterance.volume = 0.8;

                // Show voice indicator
                const voiceIndicator = document.getElementById('voiceIndicator');
                voiceIndicator.style.display = 'block';

                utterance.onend = () => {
                    voiceIndicator.style.display = 'none';
                };

                speechSynthesis.speak(utterance);
            }
        }

        // Chat functionality
        function toggleChat() {
            const chatbox = document.getElementById('chatbox');
            gameState.chatOpen = !gameState.chatOpen;
            
            if (gameState.chatOpen) {
                chatbox.classList.add('open');
            } else {
                chatbox.classList.remove('open');
            }
        }

        function handleChatEnter(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function sendMessage() {
            const chatInput = document.getElementById('chatInput');
            const message = chatInput.value.trim();
            
            if (!message) return;

            // Add user message
            addChatMessage(message, 'user');
            chatInput.value = '';

            // Simulate AI response (you can replace this with actual AI integration)
            setTimeout(() => {
                const response = generateCyberSafetyResponse(message);
                addChatMessage(response, 'bot');
                speakText(response);
            }, 1000);
        }

        function addChatMessage(message, sender) {
            const chatMessages = document.getElementById('chatMessages');
            const messageElement = document.createElement('div');
            messageElement.className = `message ${sender}`;
            messageElement.textContent = message;
            chatMessages.appendChild(messageElement);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Simple AI response generator (replace with actual AI integration)
        function generateCyberSafetyResponse(message) {
            const responses = {
                'password': 'Great question about passwords! Remember to use a mix of letters, numbers, and symbols. Never share your passwords with anyone except trusted adults!',
                'stranger': 'If someone you don\'t know tries to talk to you online, never share personal information and always tell a trusted adult!',
                'download': 'Only download things with permission from your parents, and stick to official app stores!',
                'bully': 'If someone is being mean online, don\'t respond meanly back. Block them, report them, and tell an adult!',
                'safe': 'The internet can be fun and safe when you follow the rules: don\'t share personal info, be kind to others, and always ask adults for help!',
                'help': 'I\'m here to help you stay safe online! Feel free to ask me about passwords, strangers, downloads, or any cyber safety topic!',
                'default': 'That\'s a great question! Remember the golden rules: be kind online, protect your personal information, and always ask a trusted adult if you\'re unsure about something!'
            };

            const lowerMessage = message.toLowerCase();
            
            for (let key in responses) {
                if (lowerMessage.includes(key)) {
                    return responses[key];
                }
            }
            
            return responses.default;
        }

        // Initialize the game when the page loads
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>